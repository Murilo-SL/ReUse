<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReUse - Adicionar Produto</title>
    <link rel="stylesheet" href="CSS/vendedor.css">
    <link rel="stylesheet" href="CSS/vendedor-sub.css">
    <link rel="stylesheet" href="CSS/breadcrumbs.css">
    <link rel="stylesheet" href="CSS/modo_noturno_vendedor.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <!-- VLibras -->
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app');
    </script>
</head>

<body>
    <!-- CABEÇALHO (mantido do original) -->
<header>
    <div class="container">
        <div class="top-header">
            <div class="logo-container">
                <a href="cliente.html">
                    <img src="IMG/reuse-logo-(2).svg" alt="ReUse Logo">
                    <span>ReUse</span>
                </a>
            </div>
            <div class="user-actions">
                <!-- Botão do Modo Noturno -->
                <button class="theme-toggle" id="themeToggle" aria-label="Alternar tema">
                    <i class="bi bi-sun-fill" id="themeIcon"></i>
                </button>
                <a href="login.html">
                    <i class="bi bi-box-arrow-left"></i> Sair da Conta
                </a>
            </div>
        </div>
    </div>
</header>

    <!-- DASHBOARD PRINCIPAL -->
    <div class="dashboard-container">
        <!-- Menu Lateral -->
        <aside class="sidebar">
            <h2 class="sidebar-title">Meu Brechó</h2>
            <ul class="sidebar-nav">
                <li><a href="vendedor.html"><i class="bi bi-house"></i> Início</a></li>
                <li><a href="meus_produtos.html"><i class="bi bi-box-seam"></i> Meus Produtos</a></li>
                <li><a href="add_produto_v.html" class="active"><i class="bi bi-plus-circle"></i> Adicionar Produto</a></li>
                <li><a href="estatisticas.html"><i class="bi bi-bar-chart"></i> Estatísticas</a></li>
                <li><a href="avaliacoes.html"><i class="bi bi-star-fill"></i> Avaliações</a></li>
                <li><a href="configuracoes.html"><i class="bi bi-gear"></i> Configurações</a></li>
                <li><a href="doacao.vendedor.html" id="doacao-link"><i class="bi bi-gift-fill"></i> Fazer Doação</a></li>
            </ul>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="main-content">
            <!-- Breadcrumbs -->
            <div id="breadcrumbs-container" class="breadcrumbs-vendedor">
                <a href="vendedor.html">Painel do Vendedor</a> &gt; <span>Adicionar Produto</span>
            </div>

            <h1>Adicionar Novo Produto</h1>

            <!-- Formulário de Cadastro de Produto -->
            <div class="form-container">
                <form id="produto-form" class="produto-form" enctype="multipart/form-data">
                    <div class="form-section">
                        <h2>Informações Básicas</h2>

                        <div class="form-group">
                            <label for="nome-produto">Nome do Produto *</label>
                            <input type="text" id="nome-produto" name="nome-produto" required
                                placeholder="Ex: Liquidificador Philips">
                        </div>

                        <div class="form-group">
                            <label for="descricao-produto">Descrição *</label>
                            <textarea id="descricao-produto" name="descricao-produto" rows="4" required
                                placeholder="Descreva o produto em detalhes..."></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="categoria-produto">Categoria *</label>
                                <select id="categoria-produto" name="categoria-produto" required>
                                    <option value="">Selecione uma categoria</option>
                                    <option value="Eletrodomésticos">Eletrodomésticos</option>
                                    <option value="Utensílios">Utensílios</option>
                                    <option value="Móveis">Móveis</option>
                                    <option value="Casa e Cozinha">Casa e Cozinha</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="condicao-produto">Condição *</label>
                                <select id="condicao-produto" name="condicao-produto" required>
                                    <option value="">Selecione a condição</option>
                                    <option value="Novo">Novo</option>
                                    <option value="Semi-novo">Semi-novo</option>
                                    <option value="Usado - Excelente estado">Usado - Excelente estado</option>
                                    <option value="Usado - Bom estado">Usado - Bom estado</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h2>Preço e Estoque</h2>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="preco-produto">Preço (R$) *</label>
                                <input type="number" id="preco-produto" name="preco-produto" min="0" step="0.01"
                                    required placeholder="0,00">
                            </div>

                            <div class="form-group">
                                <label for="quantidade-produto">Quantidade *</label>
                                <input type="number" id="quantidade-produto" name="quantidade-produto" min="1" required
                                    placeholder="1">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="parcelas-produto">Parcelas</label>
                            <select id="parcelas-produto" name="parcelas-produto">
                                <option value="1">À vista</option>
                                <option value="2">2x</option>
                                <option value="3" selected>3x</option>
                                <option value="4">4x</option>
                                <option value="5">5x</option>
                                <option value="6">6x</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <h2>Imagens do Produto</h2>
                        <p class="form-help">Adicione até 5 imagens do produto. A primeira imagem será a principal.</p>

                        <div class="image-upload-container">
                            <div class="image-upload-box" id="main-image-upload">
                                <i class="bi bi-camera-fill"></i>
                                <p>Imagem Principal</p>
                                <input type="file" id="imagem-principal" name="imagem-principal" accept="image/*"
                                    required>
                            </div>

                            <div class="image-upload-box">
                                <i class="bi bi-image"></i>
                                <p>Imagem 2</p>
                                <input type="file" id="imagem-2" name="imagem-2" accept="image/*">
                            </div>

                            <div class="image-upload-box">
                                <i class="bi bi-image"></i>
                                <p>Imagem 3</p>
                                <input type="file" id="imagem-3" name="imagem-3" accept="image/*">
                            </div>

                            <div class="image-upload-box">
                                <i class="bi bi-image"></i>
                                <p>Imagem 4</p>
                                <input type="file" id="imagem-4" name="imagem-4" accept="image/*">
                            </div>

                            <div class="image-upload-box">
                                <i class="bi bi-image"></i>
                                <p>Imagem 5</p>
                                <input type="file" id="imagem-5" name="imagem-5" accept="image/*">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h2>Detalhes Adicionais</h2>

                        <div class="form-group">
                            <label for="marca-produto">Marca</label>
                            <input type="text" id="marca-produto" name="marca-produto"
                                placeholder="Ex: Philips, Tramontina, etc.">
                        </div>

                        <div class="form-group">
                            <label for="medidas-produto">Medidas</label>
                            <input type="text" id="medidas-produto" name="medidas-produto"
                                placeholder="Ex: Altura: 30cm, Largura: 15cm">
                        </div>

                        <div class="form-group">
                            <label for="informacoes-produto">Informações Adicionais</label>
                            <textarea id="informacoes-produto" name="informacoes-produto" rows="3"
                                placeholder="Informações técnicas, características, etc."></textarea>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="cancel-btn" id="cancelar-btn">Cancelar</button>
                        <button type="submit" class="save-btn">Adicionar Produto</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- RODAPÉ (mantido do original) -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <!-- Seção Minha Loja -->
                <div class="footer-links">
                    <h3>Minha Loja</h3>
                    <a href="meus_produtos.html"><i class="bi bi-grid-3x3-gap-fill"></i> <span>Produtos</span></a>
                    <a href="estatisticas.html"><i class="bi bi-bar-chart-line-fill"></i> <span>Estatísticas</span></a>
                    <a href="avaliacoes.html"><i class="bi bi-star-fill"></i> <span>Avaliações</span></a>
                </div>

                <!-- Seção Configurações -->
                <div class="footer-links">
                    <h3>Configurações</h3>
                    <a href="privacidade.html"><i class="bi bi-shield-lock-fill"></i> <span>Privacidade</span></a>
                    <a href="pagamento.html"><i class="bi bi-credit-card-fill"></i> <span>Pagamentos</span></a>
                </div>

                <!-- Seção Sobre Nós -->
                <div class="footer-links">
                    <h3>Sobre Nós</h3>
                    <a href="missao.html"><i class="bi bi-info-circle-fill"></i> <span>Missão</span></a>
                    <a href="equipe.html"><i class="bi bi-people-fill"></i> <span>Equipe</span></a>
                    <a href="contato.html"><i class="bi bi-envelope-fill"></i> <span>Contato</span></a>

                    <div class="socials-title">
                        <i class="bi bi-globe2"></i>
                        <span>Redes Sociais</span>
                    </div>

                    <div class="social-links">
                        <a href="https://www.facebook.com/profile.php?id=61582645355166&locale=pt_BR" target="_blank"
                            title="Facebook"><i class="bi bi-facebook"></i></a>
                        <a href="https://www.instagram.com/projeto_reuse/" target="_blank" title="Instagram"><i
                                class="bi bi-instagram"></i></a>
                        <a href="https://x.com/Re_Use_Projeto" target="_blank" title="Twitter"><i
                                class="bi bi-twitter-x"></i></a>
                        <a href="https://github.com/Murilo-SL/ReUse" target="_blank" title="GitHub"><i
                                class="bi bi-github"></i></a>
                    </div>
                </div>
            </div>

            <div class="copyright">
                &copy; 2025 ReUse - <span>Todos os direitos reservados</span>
            </div>
        </div>
    </footer>

    <!-- Widget VLibras -->
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <script src="JS/vendedor.js"></script>
    <script src="JS/modo_noturno_vendedor.js"></script>
    <script src="JS/breadcrumbs.js"></script>
    <script src="JS/shared-navigation.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q755SR73MY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-Q755SR73MY');
    </script>

    <script>
        // ============ SISTEMA DE ARMAZENAMENTO COMPATÍVEL ============
        
        // Função para obter produtos do localStorage (compatível com vendedor-produtos.js)
        function obterProdutos() {
            const produtosSalvos = localStorage.getItem('produtosCasaUsada');
            return produtosSalvos ? JSON.parse(produtosSalvos) : {};
        }

        // Função para salvar produtos no localStorage
        function salvarProdutos(produtos) {
            localStorage.setItem('produtosCasaUsada', JSON.stringify(produtos));
            // Disparar evento personalizado para sincronização
            window.dispatchEvent(new Event('produtosAtualizados'));
        }

        // Função para gerar ID único para o produto
        function gerarIdUnico() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Função para mostrar notificações
        function mostrarNotificacao(mensagem, tipo = 'info') {
            try {
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = `alert-notification alert-${tipo}`;
                notification.innerHTML = `
                    <i class="bi bi-${tipo === 'success' ? 'check-circle' : tipo === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    ${mensagem}
                `;
                
                document.body.appendChild(notification);
                
                // Animação de entrada
                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                    notification.style.opacity = '1';
                }, 100);
                
                // Remover após 3 segundos
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }, 3000);
                
            } catch (error) {
                console.error('Erro ao mostrar notificação:', error);
            }
        }

        // ============ VALIDAÇÃO E PROCESSAMENTO DO FORMULÁRIO ============

        // Validação do formulário
        document.getElementById('produto-form').addEventListener('submit', function (e) {
            e.preventDefault();

            // Validações básicas
            const nome = document.getElementById('nome-produto').value;
            const preco = document.getElementById('preco-produto').value;
            const categoria = document.getElementById('categoria-produto').value;
            const quantidade = document.getElementById('quantidade-produto').value;
            const condicao = document.getElementById('condicao-produto').value;

            if (!nome || !preco || !categoria || !quantidade || !condicao) {
                mostrarNotificacao('Por favor, preencha todos os campos obrigatórios.', 'error');
                return;
            }

            // Processar informações adicionais
            const informacoes = document.getElementById('informacoes-produto').value;
            const informacoesArray = informacoes ? informacoes.split('\n').filter(info => info.trim() !== '') : [];

            // Processar medidas
            const medidas = document.getElementById('medidas-produto').value;
            const medidasArray = medidas ? medidas.split(',').map(medida => medida.trim()) : [];

            // Calcular preço parcelado
            const parcelas = parseInt(document.getElementById('parcelas-produto').value);
            const precoParcelado = parcelas > 1 ? parseFloat(preco) / parcelas : parseFloat(preco);

            // Criar objeto do produto com estrutura compatível
            const novoProduto = {
                id: gerarIdUnico(),
                nome: nome,
                descricao: document.getElementById('descricao-produto').value,
                categoria: categoria,
                condicao: condicao,
                precoVista: parseFloat(preco),
                precoParcelado: precoParcelado,
                parcelas: parcelas,
                quantidade: parseInt(quantidade),
                marca: document.getElementById('marca-produto').value || 'Sem marca',
                medidas: medidasArray,
                informacoes: informacoesArray,
                vendedor: "Casa Usada",
                status: "Disponível",
                dataCadastro: new Date().toISOString(),
                // Imagem padrão (será substituída quando implementar upload real)
                imagem: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjRjBGMEYwIi8+CjxwYXRoIGQ9Ik0zMCAyMEgyMFYzMEgzMFYyMFpNMzIgMzJIMThWMTguMDAwMUgzMlYzMlpNMzIgMzJIMThWMTguMDAwMUgzMlYzMloiIGZpbGw9IiNDQ0NDQ0MiLz4KPC9zdmc+"
            };

            // Salvar produto no localStorage
            salvarProduto(novoProduto);

            // Mensagem de sucesso
            mostrarNotificacao('Produto cadastrado com sucesso!', 'success');

            // Redirecionar para a página de produtos após 1.5 segundos
            setTimeout(() => {
                window.location.href = 'meus_produtos.html';
            }, 1500);
        });

        // Função para salvar produto no localStorage (compatível)
        function salvarProduto(produto) {
            let produtos = obterProdutos();
            produtos[produto.id] = produto;
            salvarProdutos(produtos);
        }

        // Cancelar e voltar
        document.getElementById('cancelar-btn').addEventListener('click', function () {
            if (confirm('Tem certeza que deseja cancelar? Todas as informações não salvas serão perdidas.')) {
                window.location.href = 'vendedor.html';
            }
        });

        // Preview de imagem (funcionalidade básica)
        const imageInputs = document.querySelectorAll('input[type="file"]');
        imageInputs.forEach(input => {
            input.addEventListener('change', function () {
                const box = this.parentElement;
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        box.style.backgroundImage = `url(${e.target.result})`;
                        box.querySelector('i').style.display = 'none';
                        box.querySelector('p').style.display = 'none';
                    }
                    reader.readAsDataURL(this.files[0]);
                }
            });
        });

        // Inicializar quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema de adição de produtos inicializado!');
        });
    </script>
</body>

</html>